<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Reports - SherLock</title>
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>
    <nav class="navbar">
        <a href="index.html" class="logo">SherLock üîç</a>
        <div class="nav-links" id="navLinks">
            <!-- Populated by app.js -->
        </div>
    </nav>

    <div class="container">
        <h2>My Reported Items</h2>
        <br>
        <div id="my-items-list">
            <!-- Items loaded here -->
            <p>Loading...</p>
        </div>
    </div>

    <script src="../js/app.js"></script>
    <script>
        async function loadMyItems() {
            try {
                const items = await fetchAPI('/items/myitems');
                const list = document.getElementById('my-items-list');
                
                if (items.length === 0) {
                    list.innerHTML = '<p>You haven\'t reported any items yet.</p>';
                    return;
                }

                list.innerHTML = items.map(item => `
                    <div class="card">
                        <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                            <div>
                                <h3>${item.title} <span class="badge ${item.status}">${item.status.toUpperCase()}</span></h3>
                                <p><strong>Type:</strong> ${item.type.toUpperCase()} | <strong>Category:</strong> ${item.category}</p>
                                <p><strong>Location:</strong> ${item.location} | <strong>Date:</strong> ${new Date(item.date).toLocaleDateString()}</p>
                                <p style="margin-top: 0.5rem;">${item.description}</p>
                            </div>
                            <button onclick="deleteItem('${item._id}')" class="btn btn-secondary" style="background-color: var(--danger); font-size: 0.8rem; padding: 0.5rem;">Delete</button>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error(error);
                document.getElementById('my-items-list').innerHTML = '<p>Error loading items.</p>';
            }
        }

        async function deleteItem(id) {
            if(!confirm('Are you sure you want to delete this item?')) return;
            try {
                await fetchAPI(`/items/${id}`, { method: 'DELETE' });
                loadMyItems();
            } catch (error) {
                alert(error.message);
            }
        }

        document.addEventListener('DOMContentLoaded', loadMyItems);
    </script>
</body>
</html>
